(function(){"use strict";var t,C=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});C.decode();var p=null;function v(){return(p===null||p.buffer!==t.memory.buffer)&&(p=new Uint8Array(t.memory.buffer)),p}function W(e,n){return C.decode(v().subarray(e,e+n))}var b=new Array(32).fill(void 0);b.push(void 0,null,!0,!1);var h=b.length;function T(e){h===b.length&&b.push(b.length+1);const n=h;return h=b[n],b[n]=e,n}function O(e){return b[e]}function I(e){e<36||(b[e]=h,h=e)}function E(e){const n=O(e);return I(e),n}var f=0;function L(e,n){const r=n(e.length*1);return v().set(e,r/1),f=e.length,r}var A=new TextEncoder("utf-8"),x=typeof A.encodeInto=="function"?function(e,n){return A.encodeInto(e,n)}:function(e,n){const r=A.encode(e);return n.set(r),{read:e.length,written:r.length}};function y(e,n,r){if(r===void 0){const s=A.encode(e),_=n(s.length);return v().subarray(_,_+s.length).set(s),f=s.length,_}let i=e.length,a=n(i);const c=v();let o=0;for(;o<i;o++){const s=e.charCodeAt(o);if(s>127)break;c[a+o]=s}if(o!==i){o!==0&&(e=e.slice(o)),a=r(a,i,i=o+e.length*3);const s=v().subarray(a+o,a+i);o+=x(e,s).written}return f=o,a}function u(e){return e==null}var k=null;function m(){return(k===null||k.buffer!==t.memory.buffer)&&(k=new Int32Array(t.memory.buffer)),k}function $(e,n){return v().subarray(e/1,e/1+n)}var M=null;function q(){return(M===null||M.buffer!==t.memory.buffer)&&(M=new Uint32Array(t.memory.buffer)),M}function B(e,n){const i=q().subarray(e/4,e/4+n),a=[];for(let c=0;c<i.length;c++)a.push(E(i[c]));return a}function D(e,n,r,i,a){var c=u(e)?0:y(e,t.__wbindgen_malloc,t.__wbindgen_realloc),o=f,s=u(n)?0:y(n,t.__wbindgen_malloc,t.__wbindgen_realloc),_=f,w=u(r)?0:y(r,t.__wbindgen_malloc,t.__wbindgen_realloc),l=f,F=u(i)?0:y(i,t.__wbindgen_malloc,t.__wbindgen_realloc),d=f,g=u(a)?0:y(a,t.__wbindgen_malloc,t.__wbindgen_realloc),z=f;const P=t.createConverter(c,o,s,_,w,l,F,d,g,z);return R.__wrap(P)}var R=class{static __wrap(e){const n=Object.create(R.prototype);return n.ptr=e,n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();t.__wbg_converter_free(e)}registerFont(e){const n=L(e,t.__wbindgen_malloc),r=f;t.converter_registerFont(this.ptr,n,r)}convert(e,n,r,i,a){try{const d=t.__wbindgen_add_to_stack_pointer(-16),g=y(e,t.__wbindgen_malloc,t.__wbindgen_realloc),z=f;var c=u(a)?0:y(a,t.__wbindgen_malloc,t.__wbindgen_realloc),o=f;t.converter_convert(d,this.ptr,g,z,!u(n),u(n)?0:n,!u(r),u(r)?0:r,!u(i),u(i)?0:i,c,o);var s=m()[d/4+0],_=m()[d/4+1],w=m()[d/4+2],l=m()[d/4+3];if(l)throw E(w);var F=$(s,_).slice();return t.__wbindgen_free(s,_*1),F}finally{t.__wbindgen_add_to_stack_pointer(16)}}list_fonts(){try{const i=t.__wbindgen_add_to_stack_pointer(-16);t.converter_list_fonts(i,this.ptr);var e=m()[i/4+0],n=m()[i/4+1],r=B(e,n).slice();return t.__wbindgen_free(e,n*4),r}finally{t.__wbindgen_add_to_stack_pointer(16)}}};async function N(e,n){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,n)}catch(i){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",i);else throw i}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,n)}else{const r=await WebAssembly.instantiate(e,n);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}async function j(e){typeof e=="undefined"&&(e=new URL("svg2png_wasm_bg.wasm",void 0));const n={};n.wbg={},n.wbg.__wbindgen_string_new=function(a,c){const o=W(a,c);return T(o)},n.wbg.__wbg_new_693216e109162396=function(){const a=new Error;return T(a)},n.wbg.__wbg_stack_0ddaca5d1abfb52f=function(a,c){const o=O(c).stack,s=y(o,t.__wbindgen_malloc,t.__wbindgen_realloc),_=f;m()[a/4+1]=_,m()[a/4+0]=s},n.wbg.__wbg_error_09919627ac0992f5=function(a,c){try{console.error(W(a,c))}finally{t.__wbindgen_free(a,c)}},n.wbg.__wbindgen_object_drop_ref=function(a){E(a)},n.wbg.__wbindgen_throw=function(a,c){throw new Error(W(a,c))},(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:i}=await N(await e,n);return t=r.exports,j.__wbindgen_wasm_module=i,t.__wbindgen_start(),t}var V=j,S=!1,H=async e=>{if(S)throw new Error("Already initialized. The `initialize` function can be used only once.");await V(await e),S=!0},J=e=>{var i,a,c,o,s,_;if(!S)throw new Error("WASM has not been initialized. Call `initialize` function.");let n;n=D((i=e==null?void 0:e.defaultFontFamily)==null?void 0:i.serifFamily,(a=e==null?void 0:e.defaultFontFamily)==null?void 0:a.sansSerifFamily,(c=e==null?void 0:e.defaultFontFamily)==null?void 0:c.cursiveFamily,(o=e==null?void 0:e.defaultFontFamily)==null?void 0:o.fantasyFamily,(s=e==null?void 0:e.defaultFontFamily)==null?void 0:s.monospaceFamily);for(const w of(_=e==null?void 0:e.fonts)!=null?_:[])n.registerFont(w);const r=(w,l)=>new Promise((F,d)=>{try{const g=n==null?void 0:n.convert(w,l==null?void 0:l.scale,l==null?void 0:l.width,l==null?void 0:l.height,l==null?void 0:l.backgroundColor);if(g)F(g);else throw new Error("Converter already disposed.")}catch(g){g instanceof Error?d(g):d(new Error(`${g}`))}});return r.dispose=()=>{n==null||n.free(),n=void 0},r.getLoadedFontFamilies=()=>{var w;return(w=n==null?void 0:n.list_fonts())!=null?w:[]},r};console.log("worker initializing");let U;self.addEventListener("message",e=>{const n=e.data;if(!(typeof n!="object"||n==null))switch(console.log(`worker ${n.type}`),n.type){case"initialize":H("/svg2png-wasm/svg2png.wasm").then(()=>{U=J(n.options)});break;case"svg2png":U===void 0?self.postMessage({type:"error",error:"svg2png has not been initialized."}):U(n.svg,n.options).then(r=>self.postMessage({id:n.id,type:"success",data:r})).catch(r=>self.postMessage({id:n.id,type:"error",error:`${r}`}));break}})})();
